<div class="booking-container">
  <div class="booking-card">
    <h1>Book an Appointment</h1>
    <p class="subtitle">Schedule your visit with our healthcare professionals</p>

    <div class="alert alert-success" *ngIf="successMessage">{{ successMessage }}</div>
    <div class="alert alert-error" *ngIf="errorMessage">{{ errorMessage }}</div>

    <div *ngIf="loading && doctors.length === 0" class="loading-message">Loading doctors...</div>

    <form (ngSubmit)="onSubmit()" class="booking-form" *ngIf="!loading || doctors.length > 0">
      <div class="form-group">
        <label for="department">Department (Specialization) *</label>
        <select id="department" [(ngModel)]="selectedDepartment" name="department" 
                (change)="onDepartmentChange()" required>
          <option value="">All Departments</option>
          <option *ngFor="let dept of departments" [value]="dept">{{ dept }}</option>
        </select>
      </div>

      <div class="form-group">
        <label for="doctor">Doctor *</label>
        <select id="doctor" [(ngModel)]="appointmentData.doctorId" name="doctor" 
                (change)="onDoctorChange()" required>
          <option value="">Select Doctor</option>
          <option *ngFor="let doc of filteredDoctors" [value]="doc.id">
            {{ doc.fullName }} - {{ doc.specialty }}
          </option>
        </select>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="date">Date *</label>
          <input type="date" id="date" [(ngModel)]="appointmentData.date" name="date" 
                 (change)="onDateChange()" [min]="getMinDate()" required>
        </div>

        <div class="form-group">
          <label for="time">Time *</label>
          <select id="time" [(ngModel)]="appointmentData.time" name="time" 
                  [disabled]="!appointmentData.doctorId || !appointmentData.date || loadingSlots" required>
            <option value="">{{ loadingSlots ? 'Loading slots...' : 'Select Time' }}</option>
            <option *ngFor="let slot of timeSlots" [value]="slot">{{ slot }}</option>
          </select>
          <small *ngIf="timeSlots.length === 0 && !loadingSlots && appointmentData.doctorId && appointmentData.date">
            No available slots for this date
          </small>
        </div>
      </div>

      <button type="submit" class="btn btn-primary" [disabled]="loading">
        {{ loading ? 'Booking...' : 'Book Appointment' }}
      </button>
    </form>
  </div>
</div>
